#!/usr/bin/env python3

from Crypto.PublicKey import RSA
from sympy.ntheory.modular import crt

ciphers = [
    2449338490543221482810276406250836999794827387765369488756813572890648039606839282895894937444325292811113733759773696409190496740575587246553671406939066,
    4141072525102378209645145472836768082047423086459506345328249881473330133139168991416549221911728640981442883266114455443332905330959081887155005611847721,
    8105360553642526652838210104118976418258176337977411469377903178717281509651038989306437071851335678379492398754341829953684287208488491230157012901474039
]

public_keys = [
    """-----BEGIN PUBLIC KEY-----
    MFkwDQYJKoZIhvcNAQEBBQADSAAwRQJAcB7ajLekGbp2xndS98v3Axm0fHB2t1g1
    gnP65K9LCzYPiheFh1Kme9k1NOn4bfGmXyfBjaCkrEgA/Xkg4LtNUQIBAw==
    -----END PUBLIC KEY-----""",
    """-----BEGIN PUBLIC KEY-----
    MFkwDQYJKoZIhvcNAQEBBQADSAAwRQJAb9hP3dzm0zYhe+YIwjqAmyNYbC1A635L
    nzaVhg8xsxjZB/z4f9SY1FtMtML9bh2cF3imjQ8pg5UnbbujwM+F0wIBAw==
    -----END PUBLIC KEY-----""",
    """-----BEGIN PUBLIC KEY-----
    MFowDQYJKoZIhvcNAQEBBQADSQAwRgJBANDvphIlywWdhpoqakFr7507RK/SQfDU
    q0kNVg9tioGtDFjuZsDwjLiBtJqGZhcBm3AqwA6r51gzSZC0RM/D2EMCAQM=
    -----END PUBLIC KEY-----""",
]


def getModulus(key):
    return RSA.import_key(key).n


moduli = map(getModulus, public_keys)
x = crt(moduli, ciphers)[0]

cube = int(x ** (1 / 3))

print(cube)  # 2754378574683306105007433562735632611126057488917183597617661687627776
print(hex(cube))  # 0x662a636b20736800000000000000000000000000000000000000000000
print("".join(map(chr, [0x66, 0x2a, 0x63, 0x6b, 0x20, 0x73, 0x68])))  # f*ck sh
